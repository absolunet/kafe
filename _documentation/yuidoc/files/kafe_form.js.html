<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>kafe/form.js - kafe</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="shortcut icon" type="image/png" href="../assets/favicon.png">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
            
                <h1><img src="http://www.absolunet.com/images/Logo_Absolunet.gif" title="kafe"></h1>
            
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: kafe version 2-alpha</em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
    <h2 class="off-left">APIs</h2>
    <div id="api-tabview" class="tabview">
        <ul class="tabs">
            <li><a href="#api-classes">Classes</a></li>
            <li><a href="#api-modules">Modules</a></li>
        </ul>

        <div id="api-tabview-filter">
            <input type="search" id="api-filter" placeholder="Type to filter APIs">
        </div>

        <div id="api-tabview-panel">
            <ul id="api-classes" class="apis classes">
            
                <li><a href="../classes/kafe.html">kafe</a></li>
            
                <li><a href="../classes/kafe.cms.drupal.html">kafe.cms.drupal</a></li>
            
                <li><a href="../classes/kafe.cms.magento.html">kafe.cms.magento</a></li>
            
                <li><a href="../classes/kafe.cms.sitecore.html">kafe.cms.sitecore</a></li>
            
                <li><a href="../classes/kafe.date.html">kafe.date</a></li>
            
                <li><a href="../classes/kafe.ext.addthis.html">kafe.ext.addthis</a></li>
            
                <li><a href="../classes/kafe.form.html">kafe.form</a></li>
            
                <li><a href="../classes/kafe.geolocation.html">kafe.geolocation</a></li>
            
                <li><a href="../classes/kafe.number.html">kafe.number</a></li>
            
                <li><a href="../classes/kafe.plugin.carousel.html">kafe.plugin.carousel</a></li>
            
                <li><a href="../classes/kafe.plugin.menu.html">kafe.plugin.menu</a></li>
            
                <li><a href="../classes/kafe.plugin.qrcode.html">kafe.plugin.qrcode</a></li>
            
                <li><a href="../classes/kafe.plugin.sticky.html">kafe.plugin.sticky</a></li>
            
                <li><a href="../classes/kafe.storage.html">kafe.storage</a></li>
            
                <li><a href="../classes/kafe.string.html">kafe.string</a></li>
            
                <li><a href="../classes/kafe.string.encrypt.html">kafe.string.encrypt</a></li>
            
                <li><a href="../classes/kafe.string.validate.html">kafe.string.validate</a></li>
            
                <li><a href="../classes/kafe.style.html">kafe.style</a></li>
            
                <li><a href="../classes/kafe.url.html">kafe.url</a></li>
            
            </ul>

            <ul id="api-modules" class="apis modules">
            
                <li><a href="../modules/kafe.html">kafe</a></li>
            
                <li><a href="../modules/kafe.cms.html">kafe.cms</a></li>
            
                <li><a href="../modules/kafe.ext.html">kafe.ext</a></li>
            
                <li><a href="../modules/kafe.plugin.html">kafe.plugin</a></li>
            
            </ul>
        </div>
    </div>
</div>

            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
        Show:
        <label for="api-show-inherited">
            <input type="checkbox" id="api-show-inherited" checked>
            Inherited
        </label>

        <label for="api-show-protected">
            <input type="checkbox" id="api-show-protected">
            Protected
        </label>

        <label for="api-show-private">
            <input type="checkbox" id="api-show-private">
            Private
        </label>
        <label for="api-show-deprecated">
            <input type="checkbox" id="api-show-deprecated">
            Deprecated
        </label>

    </div>


            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
                        <h1 class="file-heading">File: kafe/form.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
window.kafe.bonify({name:&#x27;form&#x27;, version:&#x27;1.4.1&#x27;, obj:(function(kafe,undefined){
	var $ = kafe.dependencies.jQuery;

	/**
	* ### Version 1.4.1
	* Utilitary methods for html forms and related interactions.
	*
	* @module kafe
	* @class kafe.form
	*/
	var form = {};


	/**
	* Add a class on focus to all input/textarea/select controls and the label placed immediatly before it.
	*
	* @method focus
	* @example
	*	kafe.form.focus();
	*/
	form.focus = function() {
		$(&#x27;body&#x27;).on({
			focus: function() {
				$(this).prev(&#x27;label&#x27;).andSelf().addClass(&#x27;Focus&#x27;);
			},
			blur: function() {
				$(this).prev(&#x27;label&#x27;).andSelf().removeClass(&#x27;Focus&#x27;);
			}
		}, &#x27;input, textarea, select&#x27;);
	};


	/**
	* Adds support for the placeholder attribute for older browsers (Older than IE10). If applied, a &quot;Placeholder&quot; class will also be present when the placeholder text is shown.
	*
	* @method placeholder
	* @param {String} [selector] Selector of text-based form elements. Defaults to &#x27;input&amp;#91;placeholder&amp;#93;, textarea&amp;#91;placeholder&amp;#93;&#x27; when left undefined.
	* @example
	*	kafe.form.placeholder(&#x27;.search-field&#x27;);
	* @example
	*	$(&#x27;.search-field&#x27;).kafe(&#x27;form.placeholder&#x27;);
	*/
	form.placeholder = function() {
		if (kafe.env(&#x27;ie&#x27;) &amp;&amp; kafe.env(&#x27;ie&#x27;) &lt; 10) {

			var
				_isEmpty = function () {
					return (arguments[0].replace(/^\s*|\s*$/g, &#x27;&#x27;).replace(/^\t*|\t*$/g, &#x27;&#x27;) === &#x27;&#x27;);
				},
				selector  = &#x27;input[placeholder], textarea[placeholder]&#x27;
			;

			$(&#x27;body&#x27;).on({
				focus: function() {
					var $this = $(this);
					if (_isEmpty($this.val()) || $this.val() == $this.attr(&#x27;placeholder&#x27;)) {
						$this.one(&#x27;keydown&#x27;, function() {
							$this.removeClass(&#x27;Placeholder&#x27;).val(&#x27;&#x27;);
						});
					}
				},
				blur: function() {
					var $this = $(this);
					if (_isEmpty($this.val()) || $this.val() == $this.attr(&#x27;placeholder&#x27;)) {
						$this.addClass(&#x27;Placeholder&#x27;).val($this.attr(&#x27;placeholder&#x27;));
					}
				}
			}, selector);

			$(selector).trigger(&#x27;blur&#x27;);
		}
	};


	/**
	* Detects the RETURN key, then triggers a callback.
	*
	* @method onEnter
	* @param {String|jQueryObject|DOMElement} selector Selector of text-based form elements.
	* @param {Function} callback Function to be fired by the keypress.
	* @example
	*	kafe.form.onEnter(&#x27;.search-field&#x27;, function(input) {
	*		$(input).parents(&#x27;form&#x27;).submit();
	*	});
	* @example
	*	$(&#x27;.search-field&#x27;).kafe(&#x27;form.onEnter&#x27;, function(input) {
	*		$(input).parents(&#x27;form&#x27;).submit();
	*	});
	*/
	form.onEnter = function(selector,callback) {
		$(selector).on(&#x27;keypress&#x27;, function(e) {
			if (((!!e.which) ? e.which : e.keyCode) == 13) {
				e.preventDefault();
				callback(this);
			}
		});
	};


	/**
	* Automaticaly jump the focus to the next field once the maxlength has been reached.
	*
	* @method autofocusOnNext
	* @param {String|jQueryObject|DOMElement} selector Selector of text-based form elements.
	* @example
	*	kafe.form.autofocusOnNext(&#x27;.first-name, .last-name, .email&#x27;);
	* @example
	*	$(&#x27;.first-name, .last-name, .email&#x27;).kafe(&#x27;form.autofocusOnNext&#x27;);
	*/
	form.autofocusOnNext = function(selector) {
		$(selector).on(&#x27;keyup&#x27;,function(e) {
			var
				$this = $(this),
				key   = (!!e.which) ? e.which : e.keyCode
			;

			// tab / alt+tab / arrows
			if (key != 9 &amp;&amp; key != 16 &amp;&amp; !(key &gt;=36 &amp;&amp; key &lt;=40) &amp;&amp; $this.val().length == $this.attr(&#x27;maxlength&#x27;)) {
				var inputs = $(&#x27;input, textarea, select&#x27;);
				inputs.eq( inputs.index(this)+1 ).focus().select();
			}
		});
	};


	/**
	* Adds a simulated maxlength support for textarea elements.
	*
	* @method maxLength
	* @param {String|jQueryObject|DOMElement} selector Selector of text-based form elements.
	* @param {Integer} max Maximum number of characters.
	* @param {Boolean} [block=false] Prevent further character entry once the limit is reached.
	* @param {Function} [callback] Callback triggered when the character limit is reached. The current number of characters is provided as the first argument of the callback.
	* @example
	*	kafe.form.maxLength(&#x27;.twitter-post&#x27;, 140, false, function(count) {
	*		kafe.log(count);
	*	});
	* @example
	*	$(&#x27;.twitter-post&#x27;).kafe(&#x27;form.maxLength&#x27;, 140, false, function(count) {
	*		kafe.log(count);
	*	});
	*/
	form.maxLength = function(selector, max, block, callback) {
		$(selector)
			.on(&#x27;input paste cut keyup&#x27;,function(e) {

				var
					$this = $(this),
					delay = (kafe.env(&#x27;ie&#x27;) &amp;&amp; kafe.env(&#x27;ie&#x27;) &lt; 9) ? 1 : 0
				;

				setTimeout(function(){
					var
						val   = $this.val(),
						nb    = max - val.length
					;

					if (!!block &amp;&amp; nb &lt; 0) {
						$this.val(val.toString().substr(0,max));
						nb = 0;
					}

					if ($.isFunction(callback)) {
						callback(nb);
					}

				},delay);
			})
			.trigger(&#x27;keyup&#x27;)
		;
	};


	/**
	* Calculates the password strength value of given fields.
	*
	* @method passwordStrength
	* @param {String|jQueryObject|DOMElement} selector Selector of text-based form elements.
	* @param {Function} [callback] Callback triggered when the value is changed. The calculated strengh value is provided as the first argument of the callback.
	* @example
	*	kafe.form.passwordStrength(&#x27;.password&#x27;, function(strengh) {
	*		kafe.log(strengh);
	*	});
	* @example
	*	$(&#x27;.password&#x27;).kafe(&#x27;form.passwordStrength&#x27;, function(strengh) {
	*		kafe.log(strengh);
	*	});
	*/
	form.passwordStrength = function(selector, callback) {

		var
			_countRegexp = function (val, rex) {
				var match = val.match(rex);
				return match ? match.length : 0;
			},

			_getStrength = function (val, minLength) {
				var len = val.length;

				// too short =(
				if (len &lt; minLength) {
					return 0;
				}

				var
					nums = _countRegexp(val, /\d/g),
					lowers = _countRegexp(val, /[a-z]/g),
					uppers = _countRegexp(val, /[A-Z]/g),
					specials = len - nums - lowers - uppers
				;

				// just one type of characters =(
				if (nums == len || lowers == len || uppers == len || specials == len) {
					return 1;
				}

				var strength = 0;
				if (nums) { strength += 2; }
				if (lowers) { strength += uppers ? 4 : 3; }
				if (uppers) { strength += lowers ? 4 : 3; }
				if (specials) { strength += 5; }
				if (len &gt; 10) { strength += 1; }

				return strength;
			},

			_getStrengthLevel = function(val, minLength) {
				var
					strength = _getStrength(val, minLength),
					lvl = 1
				;
				if (strength &lt;= 0) {
					lvl = 1;
				} else if (strength &gt; 0 &amp;&amp; strength &lt;= 4) {
					lvl = 2;
				} else if (strength &gt; 4 &amp;&amp; strength &lt;= 8) {
					lvl = 3;
				} else if (strength &gt; 8 &amp;&amp; strength &lt;= 12) {
					lvl = 4;
				} else if (strength &gt; 12) {
					lvl = 5;
				}

				return lvl;
			},

			min_length = 6
		;

		$(selector)
			.on(&#x27;input paste cut keyup&#x27;,function(e) {

				var
					$this = $(this),
					delay = (kafe.env(&#x27;ie&#x27;) &amp;&amp; kafe.env(&#x27;ie&#x27;) &lt; 9) ? 1 : 0
				;

				setTimeout(function(){
					var
						val = $this.val(),
						strength = _getStrengthLevel(val, min_length)
					;

					if ($.isFunction(callback)) {
						callback(strength);
					}
				},delay);
			})
		;
	};


	/**
	* Sanitize form text entry for .NET validator.
	*
	* @method sanitizeFormData
	* @param {String|jQueryObject|DOMElement} selector Reference to the current .NET form.
	* @example
	*	kafe.form.sanitizeFormData(&#x27;#Form1&#x27;);
	* @example
	*	$(&#x27;#Form1&#x27;).kafe(&#x27;form.sanitizeFormData&#x27;);
	*/
	form.sanitizeFormData = function(selector) {
		var
			$form = $(selector),
			data  = $this.serializeArray()
		;

		for (var i in data) {
			$form.find(&#x27;input[type=&quot;text&quot;][name=&quot;&#x27;+data[i].name+&#x27;&quot;],textarea[name=&quot;&#x27;+data[i].name+&#x27;&quot;]&#x27;).val(
				data[i].value.toString()
					.replace(/\\&lt;/g,&#x27;&amp;lt;&#x27;)
					.replace(/\\&gt;/g,&#x27;&amp;gt;&#x27;)
			);
		}
	};


	/**
	* Replace elements with a submit button
	*
	* @method replaceSubmit
	* @param {String|jQueryObject|DOMElement} [selector=&#x27;input:submit&#x27;] Elements to replace
	* @example
	*	kafe.form.replaceSubmit();
	* @example
	*	$(&#x27;.Search input:submit&#x27;).kafe(&#x27;form.replaceSubmit&#x27;);
	*/
	form.replaceSubmit = function(selector) {
		( (selector) ? $(selector) : $(&#x27;input:submit&#x27;) ).each(function() {
				var $this = $(this);
				$this
					.hide()
					.after( $(&#x27;&lt;button type=&quot;submit&quot; data-kafereplacesubmit-processed=&quot;true&quot; class=&quot;&#x27;+ $this.attr(&#x27;class&#x27;) +&#x27;&quot;&gt;&#x27;+ $this.val() +&#x27;&lt;/button&gt;&#x27;).on(&#x27;click&#x27;, function(e) { e.preventDefault(); $this.trigger(&#x27;click&#x27;); }) )
				;
		});
	};


	// Add as jQuery plugin
	kafe.fn.plugIntojQuery(&#x27;&#x27;, {
		&#x27;form.placeholder&#x27;: function(self, parameters) {
			form.placeholder(self);
		},
		&#x27;form.onEnter&#x27;: function(self, parameters) {
			form.onEnter(self, parameters[0]);
		},
		&#x27;form.autofocusOnNext&#x27;: function(self, parameters) {
			form.autofocusOnNext(self);
		},
		&#x27;form.maxLength&#x27;: function(self, parameters) {
			form.maxLength(self, parameters[0]);
		},
		&#x27;form.passwordStrength&#x27;: function(self, parameters) {
			form.passwordStrength(self, parameters[0]);
		},
		&#x27;form.sanitizeFormData&#x27;: function(self, parameters) {
			form.sanitizeFormData(self);
		},
		&#x27;form.replaceSubmit&#x27;: function(self, parameters) {
			form.replaceSubmit(self);
		}
	});


	return form;

})(window.kafe)});
    </pre>
</div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
